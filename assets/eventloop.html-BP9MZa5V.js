import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as s,c as a,e as t}from"./app-qKmLr34n.js";const p="/assets/image-31-B85GBZ0z.png",e="/assets/image-32-BGteXwFB.png",o="/assets/image-33-F4L21qO4.png",l="/assets/image-34-BYDxPsAB.png",c="/assets/image-35-O6Jx-vFC.png",i="/assets/image-36-BeM6DDpA.png",u="/assets/image-37-D2kRGCEZ.png",r="data:image/png;base64,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",d="data:image/png;base64,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",k="/assets/image-40-C4TZmhQB.png",v={},g=t('<p>面试题内容涉及：计时器 Promise Ajax node</p><p>PS : 事件循环与浏览器密切相关</p><h1 id="浏览器的进程模型" tabindex="-1"><a class="header-anchor" href="#浏览器的进程模型"><span>浏览器的进程模型</span></a></h1><h2 id="何为进程" tabindex="-1"><a class="header-anchor" href="#何为进程"><span>何为进程？</span></a></h2><p>程序运行需要有自己专属的内存空间，可以把这块内存空间简单理解为进程 <img src="'+p+'" alt="Alt text" loading="lazy"></p><p>每个应用至少有一个进程，进程之间相互独立，即使要通信，也要双方同意。</p><h2 id="何为线程" tabindex="-1"><a class="header-anchor" href="#何为线程"><span>何为线程？</span></a></h2><p>有了进程后，就可以运行程序的代码了。</p><p>运行代码的【人】称之为【线程】</p><p>一个进程至少有一个线程，所以在进程开启后会自动创建一个线程来运行代码，该线程称之为主线程。</p><p>如果程序需要同时执行多块代码，主线程就会启动更多的线程来执行代码，所以一个进程中可以包含多个线程。</p><figure><img src="'+e+'" alt="Alt text" tabindex="0" loading="lazy"><figcaption>Alt text</figcaption></figure><h2 id="浏览器有哪些进程和线程" tabindex="-1"><a class="header-anchor" href="#浏览器有哪些进程和线程"><span>浏览器有哪些进程和线程？</span></a></h2><p><strong>浏览器是一个多进程多线程的应用程序</strong></p><p>浏览器内部工作极其复杂。</p><p>为了避免互相影响，为了减少连环奔溃的几率，当启动浏览器后，它会自动启动多个进程。</p><figure><img src="'+o+'" alt="Alt text" tabindex="0" loading="lazy"><figcaption>Alt text</figcaption></figure><h3 id="可以在浏览器的任务管理器中查看当前所有的进程" tabindex="-1"><a class="header-anchor" href="#可以在浏览器的任务管理器中查看当前所有的进程"><span>可以在浏览器的任务管理器中查看当前所有的进程</span></a></h3><figure><img src="'+l+'" alt="Alt text" tabindex="0" loading="lazy"><figcaption>Alt text</figcaption></figure><p>其中，最主要的进程有：</p><ol><li>浏览器进程：主要负责界面显示、用户交互、紫禁城管理等，浏览器进程内部会启动多个线程处理不同的任务</li><li>网络进程：负责加载网络资源。网络进程内部会启动多个线程来处理不同的网络任务。</li><li><strong>渲染进程（重点）</strong>：渲染进程启动后，会开启一个<strong>渲染主线程</strong>，主线程负责执行HTML、CSS、JS代码；默认情况下，浏览器会为每个标签页开启一个新的渲染进程，以保证不同的标签页之间不互相影响。</li></ol><h1 id="渲染主线程是如何工作的" tabindex="-1"><a class="header-anchor" href="#渲染主线程是如何工作的"><span>渲染主线程是如何工作的？</span></a></h1><p>渲染主线程是浏览器中最繁忙的线程，需要塔处理的任务包括但不限于：</p><ul><li>解析HTML</li><li>解析CSS</li><li>计算样式</li><li>布局</li><li>处理图层</li><li>每秒把页面画60次</li><li>执行全局JS代码</li><li>执行事件处理函数</li><li>执行计时器的回调函数</li><li>...</li></ul><p><strong>思考题：为什么渲染进程不适用多个线程来处理这些事情？</strong> 要处理那么多的任务，主线程遇到了一个 前所未有的难题：<strong>如何调度任务？</strong></p><p>比如：</p><ul><li>正在执行一个JS函数，执行到一半的时候，用户点击了按钮，那么应该立即去执行点击事件的处理函数吗？（不会）</li><li>正在执行一个JS函数，执行到一半的时候，某个计时器到达了时间，该立即去执行它的回调吗？</li><li>浏览器进程通知我“用户点击了按钮”，与此同时，某个计时器也到达了时间，应该处理哪一个？？？</li><li>.....</li></ul><p>渲染主线程想出了一个绝妙的主意来处理这个问题：<strong>排队</strong><img src="'+c+'" alt="Alt text" loading="lazy"></p><ol><li>在最开始的时候，渲染主线程会进入一个无限循环</li><li>每一次循环会检查消息队列中是否有任务存在。如果有，就取出第一个任务执行，执行完一个后进入下一次循环；如果没有，则进入休眠状态。</li><li>其他所有线程（包括其他进程的线程）<strong>可以随时向消息队列添加任务</strong>。新任务会加到消息队列的末尾。再添加新任务时，如果主线程是休眠状态，则会将其唤醒以继续循环拿取任务</li></ol><p>这样一来，就可以每个任务有条不紊的，持续的进行下去</p><p><strong>整个过程称之为事件循环（消息循环）</strong></p><h1 id="若干解释" tabindex="-1"><a class="header-anchor" href="#若干解释"><span>若干解释</span></a></h1><h2 id="何为异步" tabindex="-1"><a class="header-anchor" href="#何为异步"><span>何为异步？</span></a></h2><p>代码在执行过程中，会遇到一些无法立即处理的任务。比如：</p><ul><li>计时完成后需要执行的任务 ———— setTimeout、setInterval</li><li>网络通信完成后需要执行的任务 ———— XHR、Fetch</li><li>用户操作后需要执行的任务 ———— addEventListner</li></ul><p>如果让<strong>渲染辅助线程</strong>等待这些任务的时机达到，就会导致主线程长期处于【阻塞】的状态，从而导致浏览器【卡死】</p><p><img src="'+i+'" alt="Alt text" loading="lazy"><strong>渲染主线程承担着极其重要的工作，无论如何都不能阻塞！！！</strong></p><p>因此，浏览器选择<strong>异步</strong>来解决问题，如下图</p><p><img src="'+u+`" alt="Alt text" loading="lazy"> 使用异步的方式，渲染主线程永不阻塞</p><h3 id="面试题-如何理解js的异步" tabindex="-1"><a class="header-anchor" href="#面试题-如何理解js的异步"><span>面试题：如何理解JS的异步？！！！</span></a></h3><p>JS是一门单线程的语言，这是因为它运行在浏览器的渲染主线程中，而渲染主线程只有一个。而渲染主线程承担着诸多的工作：渲染页面、执行JS都在其中。</p><p>如果使用同步的方式，就极有可能导致主线程白白的消耗时间，另一方面导致导致页面无法及时更新，给用户造成卡死现象</p><p>所以浏览器采用异步的方式来避免。具体做法是当某些任务发生时，比如计时器、网络、事件监听、主线程将任务交给其他线程去处理。自身立即结束任务的执行，转而执行后续代码。当其他线程完成时，将实现传递<strong>回调函数包装成任务</strong>，加入到消息队列的末尾排队，等待主线程<strong>调度</strong>执行。</p><p>在这种异步模式下，浏览器永不阻塞，从而最大限度地保证了单线程的流畅运行。</p><h2 id="js为何会阻碍渲染" tabindex="-1"><a class="header-anchor" href="#js为何会阻碍渲染"><span>JS为何会阻碍渲染？</span></a></h2><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">&quot;en&quot;</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">&quot;UTF-8&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">&quot;viewport&quot;</span> content<span class="token operator">=</span><span class="token string">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>Document<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>hello<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>button<span class="token operator">&gt;</span>改变<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
        <span class="token keyword">var</span> h1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;h1&#39;</span><span class="token punctuation">)</span>
        <span class="token keyword">var</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">)</span>
        <span class="token comment">// 死循环指定的时间</span>
        <span class="token keyword">function</span> <span class="token function">delay</span><span class="token punctuation">(</span><span class="token parameter">duration</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">var</span> start <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start <span class="token operator">&lt;</span> duration<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        btn<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            h1<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token string">&quot;点击后改变了&quot;</span>
            <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>点击后，页面等待3000ms后才渲染新的改变数据到页面上</p><h2 id="任务有优先级吗" tabindex="-1"><a class="header-anchor" href="#任务有优先级吗"><span>任务有优先级吗？</span></a></h2><p>任务没有优先级，在消息队列中先进先出</p><p>但<strong>消息队列最有优先级的</strong></p><p>根据W3C的最新解释：</p><ul><li>每个任务都有一个任务类型，<strong>同一个类型的任务必须在一个队列</strong>，不同类型的任务可以分属于不同的队列。在一次事件循环中，浏览器可以根据实际情况 从不同的队列中取出任务执行</li><li>浏览器必须准备好一个微队列（microtask queue），队列中的任务优先所有其他任务执行 https://html.spec.whatwg.org/multipage/webappapis.html#perform-a-microtask-checkpoint</li></ul><p>随着浏览器的复杂度急剧提升，W3C不再使用宏队列的说法</p><p>在目前chrome的实现中，至少包含了下面的队列：</p><ul><li>延时队列：用于存放计时器到达后的回调任务，优先级【中】</li><li>交互队列：用于存放用户操作后产生的事件处理任务，优先级【高】</li><li>微队列：用户存放需要最快执行的任务，优先级【最高】</li></ul><blockquote><p>添加任务到微队列的主要方式是使用 Promise、MutationObserver</p></blockquote><p>例如：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// 立即把一个函数添加到微队列</span>
Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>函数<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>浏览器还有很多其他的队列，与我们开发关系不大，这里不做考虑</p><h3 id="面试题-阐述一下js的事件循环" tabindex="-1"><a class="header-anchor" href="#面试题-阐述一下js的事件循环"><span>面试题：阐述一下JS的事件循环</span></a></h3><blockquote><p>事件循环又叫消息循环，是** **。</p><p>在Chrome的源码中，它开启一个不会结束的for循环，每次循环从消息队列中取出中去除第一个任务执行，而其他线程只需要在合适的时候将任务加入到队列末尾即可。</p><p>过去把消息队列简单分为宏任务和微任务，这种说法目前已无法满足复杂的浏览器环境，取而代之是一种更加灵活多变的处理方式。</p><p>根据W3C官方解释，每个任务有不同的类型，同类型的任务必须在同一个队列，不同的任务可以属于不同的队列，不同任务队列有不同的优先级，在一次事件循环中，由浏览器自行决定取那一队列的任务。但必须有一个微队列，微队列的任务一定具有最高的优先级，必须有限调度执行。</p></blockquote><h3 id="面试题-js中的计时器能做到精确计时吗-为什么" tabindex="-1"><a class="header-anchor" href="#面试题-js中的计时器能做到精确计时吗-为什么"><span>面试题：JS中的计时器能做到精确计时吗？为什么？</span></a></h3><p>答案：不行，因为：</p><blockquote><p>1、计算机硬件没有原子钟，无法做到精确计时</p><p>2、操作系统的计时函数本身就有少量偏差，由于JS的计时器最终调用的是操作系统的函数，也就携带了这些偏差</p><p>3、按照W3C的标准，浏览器实现计时器时，如果嵌套层级超过5层，则会带有4毫秒的最少时间，这样在计时时间少于4毫秒时又带来了偏差</p><p>4、受事件循环的影响，计时器的回调函数只能在主线程空闲时运行，因此又带来了偏差 【重要】</p></blockquote><p>练习题1：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>

        Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       
        
      <span class="token comment">//输出顺序 3  2  1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="`+r+`" alt="Alt text" tabindex="0" loading="lazy"><figcaption>Alt text</figcaption></figure><p>练习题2：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">function</span> <span class="token function">delay</span><span class="token punctuation">(</span><span class="token parameter">duration</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">var</span> start <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start <span class="token operator">&lt;</span> duration<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
       <span class="token comment">// 输出顺序：2  1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="`+d+`" alt="Alt text" tabindex="0" loading="lazy"><figcaption>Alt text</figcaption></figure><p>练习题3：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>        <span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
        Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//  输出顺序：  5 4 3 1 2</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="`+k+'" alt="Alt text" tabindex="0" loading="lazy"><figcaption>Alt text</figcaption></figure><p>总结：<strong>单线程是异步产生的原因 事件循环是异步的实现方式</strong></p>',74),m=[g];function b(f,A){return s(),a("div",null,m)}const y=n(v,[["render",b],["__file","eventloop.html.vue"]]),C=JSON.parse('{"path":"/browser/eventloop.html","title":"2. JS事件循环机制","lang":"en-US","frontmatter":{"title":"2. JS事件循环机制","icon":"object-group","order":2,"category":["Guide"],"tag":["JS事件循环机制"],"description":"面试题内容涉及：计时器 Promise Ajax node PS : 事件循环与浏览器密切相关 浏览器的进程模型 何为进程？ 程序运行需要有自己专属的内存空间，可以把这块内存空间简单理解为进程 Alt text 每个应用至少有一个进程，进程之间相互独立，即使要通信，也要双方同意。 何为线程？ 有了进程后，就可以运行程序的代码了。 运行代码的【人】称之为...","head":[["link",{"rel":"alternate","hreflang":"zh-cn","href":"https://your.domain/zh/browser/eventloop.html"}],["meta",{"property":"og:url","content":"https://your.domain/browser/eventloop.html"}],["meta",{"property":"og:site_name","content":"Docs Demo"}],["meta",{"property":"og:title","content":"2. JS事件循环机制"}],["meta",{"property":"og:description","content":"面试题内容涉及：计时器 Promise Ajax node PS : 事件循环与浏览器密切相关 浏览器的进程模型 何为进程？ 程序运行需要有自己专属的内存空间，可以把这块内存空间简单理解为进程 Alt text 每个应用至少有一个进程，进程之间相互独立，即使要通信，也要双方同意。 何为线程？ 有了进程后，就可以运行程序的代码了。 运行代码的【人】称之为..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:locale:alternate","content":"zh-CN"}],["meta",{"property":"article:author","content":"ChorKiu"}],["meta",{"property":"article:tag","content":"JS事件循环机制"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"2. JS事件循环机制\\",\\"image\\":[\\"\\"],\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"ChorKiu\\",\\"url\\":\\"https://mister-hope.com\\"}]}"]]},"headers":[{"level":2,"title":"何为进程？","slug":"何为进程","link":"#何为进程","children":[]},{"level":2,"title":"何为线程？","slug":"何为线程","link":"#何为线程","children":[]},{"level":2,"title":"浏览器有哪些进程和线程？","slug":"浏览器有哪些进程和线程","link":"#浏览器有哪些进程和线程","children":[{"level":3,"title":"可以在浏览器的任务管理器中查看当前所有的进程","slug":"可以在浏览器的任务管理器中查看当前所有的进程","link":"#可以在浏览器的任务管理器中查看当前所有的进程","children":[]}]},{"level":2,"title":"何为异步？","slug":"何为异步","link":"#何为异步","children":[{"level":3,"title":"面试题：如何理解JS的异步？！！！","slug":"面试题-如何理解js的异步","link":"#面试题-如何理解js的异步","children":[]}]},{"level":2,"title":"JS为何会阻碍渲染？","slug":"js为何会阻碍渲染","link":"#js为何会阻碍渲染","children":[]},{"level":2,"title":"任务有优先级吗？","slug":"任务有优先级吗","link":"#任务有优先级吗","children":[{"level":3,"title":"面试题：阐述一下JS的事件循环","slug":"面试题-阐述一下js的事件循环","link":"#面试题-阐述一下js的事件循环","children":[]},{"level":3,"title":"面试题：JS中的计时器能做到精确计时吗？为什么？","slug":"面试题-js中的计时器能做到精确计时吗-为什么","link":"#面试题-js中的计时器能做到精确计时吗-为什么","children":[]}]}],"git":{},"readingTime":{"minutes":8.3,"words":2489},"filePathRelative":"browser/eventloop.md","autoDesc":true}');export{y as comp,C as data};
